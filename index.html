<!DOCTYPE html>
<html>
<head>
<title>Google Sheets API Quickstart</title>
<meta charset="UTF-8" />

<script type="text/javascript" src="GConf.js"></script>
<script type="text/javascript" src="DateSheet.js"></script>
<script type="text/javascript" src="GCalSheet.js"></script>
<script type="text/javascript" src="GApiSheetProvider.js"></script>

</head>
<body>
	<p>Google Sheets API Quickstart</p>

	<pre id="content"></pre>

	<script type="text/javascript">
        /**
         * Append a pre element to the body containing the given message as its text
         * node. Used to display the results of the API call.
         * 
         * @param {string}
         *            message Text to be placed in pre element.
         */
        function appendPre(message) {
            var pre = document.getElementById('content');
            var textContent = document.createTextNode(message + '\n');
            pre.appendChild(textContent);
        }

        function loadData() {
            let gApiSheetProvider = new GApiSheetProvider(gapi);
            gApiSheetProvider.loadData(SPREADSHEET_TRAINING_RANGE, function() {
                let trainingSheet = gApiSheetProvider.gCalSheet[SPREADSHEET_TRAINING_RANGE];
                console.log(trainingSheet.info);
                console.log(trainingSheet.sheet.infoHeaders);
                console.log(trainingSheet.sheet.infoData);
            });
            gApiSheetProvider.loadData(SPREADSHEET_DIET_RANGE, function() {
                let dietSheet = gApiSheetProvider.gCalSheet[SPREADSHEET_DIET_RANGE];
                console.log(dietSheet.info);
                console.log(dietSheet.sheet.infoHeaders);
                console.log(dietSheet.sheet.infoData);
            });
           gApiSheetProvider.loadData(SPREADSHEET_WEIGHT_RANGE, function() {
                let weightSheet = gApiSheetProvider.gCalSheet[SPREADSHEET_WEIGHT_RANGE];
                console.log(weightSheet.info);
                console.log(weightSheet.sheet.infoHeaders);
                console.log(weightSheet.sheet.infoData);
            });
        }
    </script>

	<script async defer src="https://apis.google.com/js/api.js"
		onload="this.onload=function(){};loadData()"
		onreadystatechange="if (this.readyState === 'complete') this.onload()">
        
    </script>
</body>
</html>